{
    "ID": 29,
    "q_ch": "å¯¹æ‰€æœ‰å·²ç»å¼€å§‹ä½†æ˜¯å°šæœªå®Œæˆçš„ç¼çº«ä»»åŠ¡è¿›è¡Œç»Ÿè®¡ï¼Œå‰©ä½™å·¥ä½œé‡æœ€å¤šçš„å·¥ä½œç»„æ˜¯å“ªä¸ªï¼Ÿ",
    "q_en": "Which workgroup has the highest remaining workload for all sewing tasks that have been started but not yet completed?",
    "gt": "Hey there! ğŸ˜„ Based on the data, the workgroup with the highest remaining workload for all sewing tasks that have been started but not yet completed is the **Master Sewers**. Here's a quick summary of the remaining workloads for each workgroup:\n\n| Workgroup Name   | Remaining Workload |\n|------------------|--------------------|\n| Master Sewers    | 40                 |\n| Skilled Sewers   | 0                  |\n| Advanced Sewers  | 0                  |\n| Premier Sewers   | 0                  |\n| Elite Sewers     | 0                  |\n\nIt looks like the Master Sewers have a bit more to finish up compared to the others. Keep up the great work, Master Sewers! ğŸ’ªğŸ§µ",
    "steps": [
        {
            "type": "SQL",
            "sql": "SELECT id, name FROM working_group WHERE type = 'sew';",
            "description": "Retrieve the IDs and names of all working groups",
            "results": [
                {
                    "id": 2,
                    "name": "Master Sewers"
                },
                {
                    "id": 7,
                    "name": "Skilled Sewers"
                },
                {
                    "id": 8,
                    "name": "Advanced Sewers"
                },
                {
                    "id": 9,
                    "name": "Premier Sewers"
                },
                {
                    "id": 10,
                    "name": "Elite Sewers"
                }
            ]
        },
        {
            "type": "SQL",
            "sql": "SELECT working_group_id, SUM(planned_number) AS total_planned, SUM(completed_number) AS total_completed FROM sewing_tasks WHERE status = 1 GROUP BY working_group_id;",
            "description": "Retrieve the total planned number and completed number of sewing tasks for each working group that have been started but not yet completed",
            "results": [
                {
                    "working_group_id": 2,
                    "total_planned": "1260",
                    "total_completed": "1220"
                },
                {
                    "working_group_id": 7,
                    "total_planned": "535",
                    "total_completed": "535"
                },
                {
                    "working_group_id": 8,
                    "total_planned": "460",
                    "total_completed": "460"
                },
                {
                    "working_group_id": 9,
                    "total_planned": "390",
                    "total_completed": "390"
                },
                {
                    "working_group_id": 10,
                    "total_planned": "260",
                    "total_completed": "260"
                }
            ]
        },
        {
            "type": "SQL",
            "sql": "SELECT working_group_id, (total_planned - total_completed) AS remaining_workload FROM (SELECT working_group_id, SUM(planned_number) AS total_planned, SUM(completed_number) AS total_completed FROM sewing_tasks WHERE status = 1 GROUP BY working_group_id) AS workload;",
            "description": "Calculate the remaining workload for each working group by subtracting the total completed number from the total planned number",
            "results": [
                {
                    "working_group_id": 2,
                    "remaining_workload": "40"
                },
                {
                    "working_group_id": 7,
                    "remaining_workload": "0"
                },
                {
                    "working_group_id": 8,
                    "remaining_workload": "0"
                },
                {
                    "working_group_id": 9,
                    "remaining_workload": "0"
                },
                {
                    "working_group_id": 10,
                    "remaining_workload": "0"
                }
            ]
        },
        {
            "type": "SQL",
            "sql": "SELECT name FROM working_group WHERE id = (SELECT working_group_id FROM (SELECT working_group_id, (total_planned - total_completed) AS remaining_workload FROM (SELECT working_group_id, SUM(planned_number) AS total_planned, SUM(completed_number) AS total_completed FROM sewing_tasks WHERE status = 1 GROUP BY working_group_id) AS workload ORDER BY remaining_workload DESC LIMIT 1) AS max_workload);",
            "description": "Identify the working group with the highest remaining workload",
            "results": [
                {
                    "name": "Master Sewers"
                }
            ]
        }
    ]
}