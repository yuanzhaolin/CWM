{
  "ID": 51,
  "q_ch": "未完成的订单中，哪个订单完成的进度最快？",
  "q_en": "Which order has the fastest completion progress among the unfinished orders?",
  "sqls": [
    {
      "command": [
        "SELECT order_product_id, SUM(completed_number) / SUM(planned_number) AS cutting_progress\n FROM cutting_tasks\n WHERE is_started = TRUE AND completed_number < planned_number\n GROUP BY order_product_id;",
        "SELECT order_product_id, SUM(completed_number) / SUM(planned_number) AS sewing_progress\n FROM sewing_tasks\n WHERE is_started = TRUE AND completed_number < planned_number\n GROUP BY order_product_id;",
        "SELECT op.order_id, (COALESCE(ct.cutting_progress, 0) + COALESCE(st.sewing_progress, 0)) / 2 AS overall_progress\n FROM order_product op\n LEFT JOIN (SELECT order_product_id, SUM(completed_number) / SUM(planned_number) AS cutting_progress\n            FROM cutting_tasks\n            WHERE is_started = TRUE AND completed_number < planned_number\n            GROUP BY order_product_id) ct ON op.id = ct.order_product_id\n LEFT JOIN (SELECT order_product_id, SUM(completed_number) / SUM(planned_number) AS sewing_progress\n            FROM sewing_tasks\n            WHERE is_started = TRUE AND completed_number < planned_number\n            GROUP BY order_product_id) st ON op.id = st.order_product_id;",
        "SELECT order_id\n FROM (SELECT op.order_id, (COALESCE(ct.cutting_progress, 0) + COALESCE(st.sewing_progress, 0)) / 2 AS overall_progress\n       FROM order_product op\n       LEFT JOIN (SELECT order_product_id, SUM(completed_number) / SUM(planned_number) AS cutting_progress\n                  FROM cutting_tasks\n                  WHERE is_started = TRUE AND completed_number < planned_number\n                  GROUP BY order_product_id) ct ON op.id = ct.order_product_id\n       LEFT JOIN (SELECT order_product_id, SUM(completed_number) / SUM(planned_number) AS sewing_progress\n                  FROM sewing_tasks\n                  WHERE is_started = TRUE AND completed_number < planned_number\n                  GROUP BY order_product_id) st ON op.id = st.order_product_id) progress\n ORDER BY overall_progress DESC\n LIMIT 1;"
      ],
      "Result of executing SQL": [
        [
          {
            "order_product_id": "op15",
            "cutting_progress": null
          },
          {
            "order_product_id": "op30",
            "cutting_progress": null
          },
          {
            "order_product_id": "op32",
            "cutting_progress": null
          }
        ],
        [
          {
            "order_product_id": "op4",
            "sewing_progress": null
          },
          {
            "order_product_id": "op7",
            "sewing_progress": null
          }
        ],
        [
          {
            "order_id": "o1",
            "overall_progress": null
          },
          {
            "order_id": "o2",
            "overall_progress": null
          },
          {
            "order_id": "o4",
            "overall_progress": null
          },
          {
            "order_id": "o8",
            "overall_progress": null
          },
          {
            "order_id": "o10",
            "overall_progress": null
          },
          {
            "order_id": "o1",
            "overall_progress": null
          },
          {
            "order_id": "o1",
            "overall_progress": null
          },
          {
            "order_id": "o1",
            "overall_progress": null
          },
          {
            "order_id": "o1",
            "overall_progress": null
          },
          {
            "order_id": "o11",
            "overall_progress": null
          },
          {
            "order_id": "o12",
            "overall_progress": null
          },
          {
            "order_id": "o2",
            "overall_progress": null
          },
          {
            "order_id": "o2",
            "overall_progress": null
          },
          {
            "order_id": "o2",
            "overall_progress": null
          },
          {
            "order_id": "o2",
            "overall_progress": null
          },
          {
            "order_id": "o3",
            "overall_progress": null
          },
          {
            "order_id": "o3",
            "overall_progress": null
          },
          {
            "order_id": "o3",
            "overall_progress": null
          },
          {
            "order_id": "o3",
            "overall_progress": null
          },
          {
            "order_id": "o4",
            "overall_progress": null
          },
          {
            "order_id": "o4",
            "overall_progress": null
          },
          {
            "order_id": "o4",
            "overall_progress": null
          },
          {
            "order_id": "o5",
            "overall_progress": null
          },
          {
            "order_id": "o5",
            "overall_progress": null
          },
          {
            "order_id": "o5",
            "overall_progress": null
          },
          {
            "order_id": "o6",
            "overall_progress": null
          },
          {
            "order_id": "o6",
            "overall_progress": null
          },
          {
            "order_id": "o6",
            "overall_progress": null
          },
          {
            "order_id": "o7",
            "overall_progress": null
          },
          {
            "order_id": "o7",
            "overall_progress": null
          },
          {
            "order_id": "o7",
            "overall_progress": null
          },
          {
            "order_id": "o8",
            "overall_progress": null
          },
          {
            "order_id": "o8",
            "overall_progress": null
          },
          {
            "order_id": "o9",
            "overall_progress": null
          }
        ],
        [
          {
            "order_id": "o8"
          }
        ]
      ]
    }
  ],
  "total_tokens": 3502
}